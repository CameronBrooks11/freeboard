# ==============================================
# FREEBOARD ENVIRONMENT CONFIGURATION
# ==============================================
# Copy this file to .env and modify values as needed
# All variables show their default values when not set
# API env load order:
# 1) process env (shell/CI)
# 2) packages/api/.env (optional package-local override)
# 3) repo root .env
# 4) API defaults

# ==============================================
# API Configuration (packages/api)
# ==============================================

# MongoDB connection string
# Used by: packages/api/src/config.js
MONGO_URL=mongodb://freeboard:unsecure@127.0.0.1:27017/freeboard

# API server port
# Used by: packages/api/src/config.js
PORT=4001

# JWT authentication secret key
# Used by: packages/api/src/config.js
# Non-development deployments must set a strong value (>=32 chars)
JWT_SECRET=replace-with-a-long-random-secret-at-least-32-chars

# JWT token expiration time (e.g., "2h", "1d", "7d")
# Used by: packages/api/src/config.js
JWT_TIME_EXPIRATION=2h

# Maximum number of users allowed (0 = unlimited)
# Used by: packages/api/src/config.js
USER_LIMIT=0

# Default admin user email
# Used by: packages/api/src/config.js
# Must be valid email format: name@domain.ext
ADMIN_EMAIL=admin@example.local

# Default admin user password
# Used by: packages/api/src/config.js
# Must be >=12 chars and include uppercase, lowercase, number, and symbol
ADMIN_PASSWORD=ChangeMe123!

# Whether to create admin user on startup (true/false)
# Used by: packages/api/src/config.js
CREATE_ADMIN=false

# ==============================================
# Proxy Configuration (packages/proxy)
# ==============================================

# Proxy server port
# Note: Uses same PORT variable as API - set per service if running separately
# Used by: packages/proxy/src/index.js
# PORT=8001
# PROXY_ALLOWED_HOSTS=api.open-meteo.com,api.coingecko.com,*.example.com
# PROXY_ALLOWED_PORTS=80,443
# PROXY_TIMEOUT_MS=15000
# PROXY_MAX_RESPONSE_BYTES=5242880
# PROXY_ALLOW_PRIVATE_DESTINATIONS=false
# PROXY_ALLOW_INSECURE_TLS=false

# ==============================================
# UI/Build Configuration (packages/ui)
# ==============================================

# Enable static build mode (for GitHub Pages deployment)
# Used by: packages/ui/vite.config.js
# FREEBOARD_STATIC=false

# Custom path to node_modules directory
# Used by: packages/ui/vite.config.js
# FREEBOARD_NODE_MODULES=./../../node_modules

# Package version (automatically set by npm)
# Used by: packages/ui/vite.config.js
# npm_package_version=1.2.0-dev

# Vite base URL for routing
# Used by: packages/ui/src/router/index.js
# BASE_URL=/

# ==============================================
# Auth/Role Policy Controls (packages/api)
# ==============================================
# Registration mode: disabled | invite | open
AUTH_REGISTRATION_MODE=disabled

# Default role for self-registration in open mode: viewer | editor
AUTH_REGISTRATION_DEFAULT_ROLE=viewer

# Whether editors can publish dashboards (true/false)
AUTH_EDITOR_CAN_PUBLISH=false

# Default visibility for new dashboards: private | link | public
DASHBOARD_DEFAULT_VISIBILITY=private

# Whether public dashboards are included in standard dashboard listings (true/false)
DASHBOARD_PUBLIC_LISTING_ENABLED=false

# Execution mode policy: safe | trusted
EXECUTION_MODE=safe

# Lock in-app policy mutation endpoints (true/false)
POLICY_EDIT_LOCK=false

# ==============================================
# Docker Compose Configuration
# ==============================================

# Runtime mode for containerized API/proxy (`production` recommended)
# Used by: docker-compose.yml
FREEBOARD_RUNTIME_ENV=production

# MongoDB Docker image version
# Used by: docker-compose.mongo.yml
FREEBOARD_MONGO_IMAGE=mongo:7.0
# For Raspberry Pi 4, use:  (tested with unofficial image)
#FREEBOARD_MONGO_IMAGE=mongodb-raspberrypi4-unofficial-r7.0.4:latest

# MongoDB connection for containerized API
# Used by: docker-compose.yml
FREEBOARD_MONGO_URL=mongodb://freeboard:unsecure@freeboard-mongo:27017/freeboard

# Containerized API uses `JWT_SECRET` defined above in API Configuration.

# Required for containerized proxy in production mode
# Comma-separated host allowlist (example values)
# Used by: docker-compose.yml -> packages/proxy/src/index.js
PROXY_ALLOWED_HOSTS=api.open-meteo.com,api.coingecko.com

# MongoDB initialization (Docker internal)
# Used by: docker-compose.mongo.yml (hardcoded in compose file)
# MONGO_INITDB_ROOT_USERNAME=freeboard
# MONGO_INITDB_ROOT_PASSWORD=unsecure
# MONGO_INITDB_DATABASE=freeboard

# ==============================================
# Raspberry Pi Player Configuration
# ==============================================

# URL for the Raspberry Pi kiosk player
# Used by: player.sh
FREEBOARD_PLAYER_URL=http://localhost:8080

# ==============================================
# System/Development Configuration
# ==============================================

# User for Ansible deployment (automatically detected)
# Used by: ansible/playbook.yml
# USER=your-username

# Docker container ports (defined in Dockerfiles, not configurable via env)
# API: 4001, Proxy: 8001, UI: 80

# ==============================================
# Development Notes
# ==============================================

# For local development:
# 1. Copy this file to .env
# 2. Modify values as needed
# 3. For first-run local login bootstrap, set CREATE_ADMIN=true once and define
#    ADMIN_EMAIL / ADMIN_PASSWORD, then set CREATE_ADMIN=false after admin exists.
# 4. Run: npm run dev

# For Docker deployment:
# 1. Copy this file to .env
# 2. Modify FREEBOARD_* variables plus JWT_SECRET and PROXY_ALLOWED_HOSTS
# 3. Run: docker compose up -d

# For static GitHub Pages build:
# 1. Set FREEBOARD_STATIC=true
# 2. Run: npm run build

# For Raspberry Pi kiosk:
# 1. Set FREEBOARD_PLAYER_URL to your dashboard URL
# 2. Set USER environment variable (usually auto-detected)
# 3. Run the ansible playbook

# Note: Local mongo data persists in the named Docker volume `freeboard-mongo-data`
# (preferred for Windows and Linux dev consistency).
